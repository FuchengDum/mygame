# 项目任务分解规划

## 已明确的决策

- 纯前端项目，无后端服务
- 技术栈：React 18 + TypeScript + Vite + Tailwind CSS + Zustand + React Router v6 + Phaser 3
- 三级页面结构：首页(游戏列表) → 游戏详情页 → 游戏运行页
- 深色主题 + 霓虹渐变强调色设计风格
- 支持横竖屏适配 + 安全区域处理
- 虚拟按键系统（方向键 + 动作按钮）
- **游戏数据来源**：本地 JSON 文件（`/public/data/games.json`）
- **游戏资源加载**：打包在项目中（`/public/assets/`）
- **用户系统**：localStorage 本地存储游戏进度

## 整体规划概述

### 项目目标

构建一个可在手机端浏览器运行的游戏平台，支持：
- 游戏列表展示与搜索
- 游戏详情查看
- 游戏运行与虚拟控制器
- 跨浏览器兼容（Safari、Chrome、微信内置浏览器）

### 技术栈

| 类别 | 技术选型 |
|------|----------|
| 框架 | React 18 |
| 语言 | TypeScript |
| 构建工具 | Vite |
| 样式 | Tailwind CSS |
| 状态管理 | Zustand |
| 路由 | React Router v6 |
| 游戏引擎 | Phaser 3 |

### 主要阶段

1. **基础架构搭建**：项目初始化、路由配置、全局样式
2. **核心页面开发**：首页、详情页、游戏运行页
3. **游戏系统集成**：Phaser 引擎集成、虚拟控制器
4. **适配与优化**：横竖屏适配、全屏模式、性能优化

---

## 详细任务分解

### 阶段 1：基础架构搭建

#### 任务 1.1：项目初始化
- **模块**：前端
- **目标**：使用 Vite 创建 React + TypeScript 项目
- **输入**：技术栈需求
- **输出**：可运行的项目骨架
- **涉及文件**：
  - `/package.json`
  - `/vite.config.ts`
  - `/tsconfig.json`
  - `/index.html`
- **验收标准**：
  - [ ] `npm run dev` 可正常启动
  - [ ] TypeScript 编译无错误
  - [ ] 项目结构清晰规范
- **预估工作量**：0.5h

#### 任务 1.2：Tailwind CSS 配置
- **模块**：前端
- **目标**：配置 Tailwind CSS 及深色主题
- **输入**：UI/UX 设计方案（深色主题 + 霓虹渐变）
- **输出**：完整的样式系统配置
- **涉及文件**：
  - `/tailwind.config.js`
  - `/postcss.config.js`
  - `/src/index.css`
- **验收标准**：
  - [ ] Tailwind 类名生效
  - [ ] 自定义霓虹渐变色可用
  - [ ] 深色主题变量配置完成
- **预估工作量**：0.5h

#### 任务 1.3：路由系统配置
- **模块**：前端
- **目标**：配置 React Router v6 三级页面路由
- **输入**：页面结构需求
- **输出**：完整的路由配置
- **涉及文件**：
  - `/src/router/index.tsx`
  - `/src/App.tsx`
- **验收标准**：
  - [ ] 首页路由 `/` 可访问
  - [ ] 详情页路由 `/game/:id` 可访问
  - [ ] 游戏页路由 `/play/:id` 可访问
  - [ ] 路由切换动画流畅
- **预估工作量**：0.5h

#### 任务 1.4：Zustand 状态管理配置
- **模块**：前端
- **目标**：配置全局状态管理
- **输入**：状态需求分析
- **输出**：状态管理 store
- **涉及文件**：
  - `/src/store/gameStore.ts`
  - `/src/store/uiStore.ts`
- **验收标准**：
  - [ ] 游戏列表状态可管理
  - [ ] UI 状态（全屏、横竖屏）可管理
  - [ ] 状态持久化配置完成
- **预估工作量**：0.5h

---

### 阶段 2：核心页面开发

#### 任务 2.1：首页 - 游戏列表页
- **模块**：前端
- **目标**：实现游戏列表展示、搜索、分类筛选
- **输入**：UI 设计稿、游戏数据结构
- **输出**：完整的首页组件
- **涉及文件**：
  - `/src/pages/HomePage.tsx`
  - `/src/components/GameCard.tsx`
  - `/src/components/SearchBar.tsx`
  - `/src/components/CategoryFilter.tsx`
- **UI/UX 设计要点**：
  - 顶部搜索栏固定，带霓虹边框效果
  - 游戏卡片网格布局（2列），卡片带悬浮发光效果
  - 底部安全区域留白
  - 下拉刷新、上拉加载更多
- **验收标准**：
  - [ ] 游戏卡片正确展示（封面、名称、分类）
  - [ ] 搜索功能可用
  - [ ] 分类筛选可用
  - [ ] 点击卡片跳转详情页
  - [ ] 移动端触摸滚动流畅
- **预估工作量**：2h

#### 任务 2.2：游戏详情页
- **模块**：前端
- **目标**：展示游戏详细信息，提供开始游戏入口
- **输入**：UI 设计稿、游戏详情数据
- **输出**：完整的详情页组件
- **涉及文件**：
  - `/src/pages/GameDetailPage.tsx`
  - `/src/components/GameInfo.tsx`
  - `/src/components/ScreenshotGallery.tsx`
- **UI/UX 设计要点**：
  - 顶部大图展示区（支持截图轮播）
  - 游戏信息卡片（名称、描述、操作说明）
  - 底部固定「开始游戏」按钮，霓虹渐变背景
  - 返回按钮位于安全区域内
- **验收标准**：
  - [ ] 游戏封面/截图正确展示
  - [ ] 游戏名称、描述、操作说明展示
  - [ ] 「开始游戏」按钮跳转游戏页
  - [ ] 返回按钮功能正常
- **预估工作量**：1.5h

#### 任务 2.3：游戏运行页框架
- **模块**：前端
- **目标**：创建游戏运行页面容器
- **输入**：页面结构需求
- **输出**：游戏页面框架
- **涉及文件**：
  - `/src/pages/GamePlayPage.tsx`
  - `/src/components/GameContainer.tsx`
- **UI/UX 设计要点**：
  - 全屏沉浸式布局
  - 游戏画布居中自适应
  - 顶部悬浮工具栏（暂停、全屏、退出）
  - 工具栏自动隐藏，点击屏幕显示
- **验收标准**：
  - [ ] 页面全屏显示
  - [ ] 游戏容器正确渲染
  - [ ] 工具栏显示/隐藏功能正常
  - [ ] 退出按钮返回详情页
- **预估工作量**：1h

---

### 阶段 3：游戏系统集成

#### 任务 3.1：Phaser 3 引擎集成
- **模块**：前端
- **目标**：集成 Phaser 3 游戏引擎到 React
- **输入**：Phaser 3 文档、React 集成方案
- **输出**：可复用的 Phaser 组件
- **涉及文件**：
  - `/src/game/PhaserGame.tsx`
  - `/src/game/scenes/BaseScene.ts`
  - `/src/game/config.ts`
- **验收标准**：
  - [ ] Phaser 游戏实例正确创建
  - [ ] 游戏画布响应式适配
  - [ ] React 组件与 Phaser 生命周期同步
  - [ ] 游戏资源正确加载
- **预估工作量**：2h

#### 任务 3.2：虚拟控制器 - 方向键
- **模块**：前端
- **目标**：实现虚拟方向键（D-Pad）
- **输入**：UI 设计稿、触摸事件需求
- **输出**：方向键组件
- **涉及文件**：
  - `/src/components/VirtualController/DPad.tsx`
  - `/src/components/VirtualController/index.tsx`
  - `/src/hooks/useGameInput.ts`
- **UI/UX 设计要点**：
  - 左下角固定位置，半透明设计
  - 支持 8 方向输入
  - 触摸反馈（按下高亮）
  - 可拖拽调整位置（可选）
- **验收标准**：
  - [ ] 方向键正确响应触摸
  - [ ] 支持上下左右及对角方向
  - [ ] 触摸反馈视觉效果
  - [ ] 输入事件正确传递给游戏
- **预估工作量**：2h

#### 任务 3.3：虚拟控制器 - 动作按钮
- **模块**：前端
- **目标**：实现虚拟动作按钮（A/B/X/Y）
- **输入**：UI 设计稿、按钮配置需求
- **输出**：动作按钮组件
- **涉及文件**：
  - `/src/components/VirtualController/ActionButtons.tsx`
  - `/src/components/VirtualController/index.tsx`
- **UI/UX 设计要点**：
  - 右下角固定位置，半透明设计
  - 按钮带霓虹边框效果
  - 支持多点触控（同时按多个按钮）
  - 触摸反馈（按下缩放 + 发光）
- **验收标准**：
  - [ ] 动作按钮正确响应触摸
  - [ ] 支持多点触控
  - [ ] 触摸反馈视觉效果
  - [ ] 按钮事件正确传递给游戏
- **预估工作量**：1.5h

#### 任务 3.4：示例游戏开发
- **模块**：前端
- **目标**：开发一个简单的示例游戏验证系统
- **输入**：游戏设计需求
- **输出**：可玩的示例游戏
- **涉及文件**：
  - `/src/game/games/DemoGame/index.ts`
  - `/src/game/games/DemoGame/scenes/`
  - `/public/assets/demo-game/`
- **验收标准**：
  - [ ] 游戏可正常加载运行
  - [ ] 虚拟控制器输入响应正确
  - [ ] 游戏暂停/继续功能正常
  - [ ] 游戏退出功能正常
- **预估工作量**：3h

---

### 阶段 4：适配与优化

#### 任务 4.1：横竖屏适配
- **模块**：前端
- **目标**：实现横竖屏自动适配
- **输入**：适配需求
- **输出**：响应式布局系统
- **涉及文件**：
  - `/src/hooks/useOrientation.ts`
  - `/src/components/OrientationGuard.tsx`
  - `/src/styles/orientation.css`
- **验收标准**：
  - [ ] 检测屏幕方向变化
  - [ ] 游戏页强制横屏提示（可选）
  - [ ] 列表页竖屏优化布局
  - [ ] 控制器位置随方向调整
- **预估工作量**：1.5h

#### 任务 4.2：全屏模式实现
- **模块**：前端
- **目标**：实现跨浏览器全屏功能
- **输入**：浏览器兼容性需求
- **输出**：全屏控制 Hook
- **涉及文件**：
  - `/src/hooks/useFullscreen.ts`
  - `/src/utils/fullscreen.ts`
- **验收标准**：
  - [ ] Safari 全屏兼容
  - [ ] Chrome 全屏兼容
  - [ ] 微信浏览器全屏兼容（或降级处理）
  - [ ] 全屏状态正确同步
- **预估工作量**：1h

#### 任务 4.3：安全区域处理
- **模块**：前端
- **目标**：处理 iPhone 刘海屏等安全区域
- **输入**：安全区域规范
- **输出**：安全区域适配样式
- **涉及文件**：
  - `/src/styles/safe-area.css`
  - `/index.html`（viewport meta）
- **验收标准**：
  - [ ] 内容不被刘海遮挡
  - [ ] 底部 Home 指示器区域留白
  - [ ] 横屏时左右安全区域处理
- **预估工作量**：0.5h

#### 任务 4.4：性能优化
- **模块**：前端
- **目标**：优化加载速度和运行性能
- **输入**：性能指标需求
- **输出**：优化后的构建配置
- **涉及文件**：
  - `/vite.config.ts`
  - `/src/utils/lazyLoad.ts`
- **验收标准**：
  - [ ] 首屏加载 < 3s（4G 网络）
  - [ ] 游戏运行 60fps
  - [ ] 路由懒加载配置
  - [ ] 图片资源压缩优化
- **预估工作量**：1h

#### 任务 4.5：PWA 支持（可选）
- **模块**：前端
- **目标**：添加 PWA 支持，可添加到主屏幕
- **输入**：PWA 规范
- **输出**：PWA 配置文件
- **涉及文件**：
  - `/public/manifest.json`
  - `/src/sw.ts`
  - `/vite.config.ts`
- **验收标准**：
  - [ ] 可添加到主屏幕
  - [ ] 离线缓存基础资源
  - [ ] 启动画面配置
- **预估工作量**：1h

---

---

## 风险识别与应对

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 微信浏览器兼容性问题 | 高 | 提前测试、准备降级方案 |
| Phaser 与 React 集成冲突 | 中 | 使用成熟的集成方案、隔离渲染 |
| 虚拟按键触摸延迟 | 中 | 使用 touch 事件、禁用默认行为 |
| 移动端性能不足 | 中 | 限制游戏复杂度、优化渲染 |

---

## 项目结构预览

```
/Users/dum/google/proj/mygame/
├── public/
│   ├── assets/           # 游戏资源
│   └── manifest.json     # PWA 配置
├── src/
│   ├── components/       # 通用组件
│   │   ├── GameCard.tsx
│   │   ├── SearchBar.tsx
│   │   └── VirtualController/
│   ├── pages/            # 页面组件
│   │   ├── HomePage.tsx
│   │   ├── GameDetailPage.tsx
│   │   └── GamePlayPage.tsx
│   ├── game/             # Phaser 游戏相关
│   │   ├── PhaserGame.tsx
│   │   ├── config.ts
│   │   └── games/
│   ├── store/            # Zustand 状态
│   ├── hooks/            # 自定义 Hooks
│   ├── router/           # 路由配置
│   ├── styles/           # 全局样式
│   └── utils/            # 工具函数
├── index.html
├── package.json
├── vite.config.ts
├── tailwind.config.js
└── tsconfig.json
```

---

## 用户反馈区域

请在此区域补充您对整体规划的意见和建议：

```
用户补充内容：
_______________________________________________
_______________________________________________
_______________________________________________
```

---

## 时间估算汇总

| 阶段 | 预估工时 |
|------|----------|
| 阶段 1：基础架构搭建 | 2h |
| 阶段 2：核心页面开发 | 4.5h |
| 阶段 3：游戏系统集成 | 8.5h |
| 阶段 4：适配与优化 | 5h |
| **总计** | **20h** |

*注：以上为纯开发时间估算，不含测试和调试时间*
