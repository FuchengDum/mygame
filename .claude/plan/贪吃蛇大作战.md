# 贪吃蛇大作战 - 功能规划

## 已明确的决策

- 使用 Phaser 3 游戏引擎开发
- 复用现有 `PhaserGame.tsx` 组件和 `createGameConfig` 配置
- 视觉风格：深色背景 + 霓虹渐变（青色蛇头 → 紫色蛇身 → 粉色蛇尾）
- 游戏画布尺寸：800x600
- 使用 Zustand 的 `saveProgress/getProgress` 存储最高分
- 游戏数据源：`/public/data/games.json`

---

## 任务分解

### 阶段 1：虚拟摇杆控制器

#### 任务 1.1：创建 Joystick 摇杆组件
- **目标**：实现 360 度方向输入的虚拟摇杆
- **涉及文件**：
  - 新建 `src/components/VirtualController/Joystick.tsx`
  - 修改 `src/components/VirtualController/index.tsx`
- **验收标准**：摇杆可拖动，释放后回弹，输出正确的角度值

---

### 阶段 2：贪吃蛇核心游戏逻辑

#### 任务 2.1：创建 SnakeScene 游戏场景
- **目标**：搭建贪吃蛇游戏的基础场景结构
- **涉及文件**：
  - 新建 `src/game/games/SnakeGame/SnakeScene.ts`
- **验收标准**：场景可加载，无报错

#### 任务 2.2：实现蛇的数据结构与渲染
- **目标**：创建蛇的身体段数组，实现霓虹渐变渲染
- **验收标准**：蛇显示霓虹渐变效果，初始 3-5 节身体

#### 任务 2.3：实现蛇的 360 度移动控制
- **目标**：根据摇杆输入角度平滑控制蛇头方向
- **验收标准**：蛇头朝向跟随摇杆方向，身体平滑跟随

#### 任务 2.4：实现食物系统
- **目标**：随机生成食物，两种类型（普通 +10 分、大型 +30 分）
- **验收标准**：食物随机出现，两种类型视觉区分明显

#### 任务 2.5：实现碰撞检测
- **目标**：检测蛇头与食物、自身、边界的碰撞
- **验收标准**：吃食物身体增长，撞墙/自己触发游戏结束

#### 任务 2.6：实现分数系统
- **目标**：记录当前分数，通过 Zustand 持久化最高分
- **验收标准**：分数实时更新，最高分跨会话保持

---

### 阶段 3：游戏状态与 UI

#### 任务 3.1：创建贪吃蛇游戏专用页面
- **目标**：创建 SnakeGamePage，集成 SnakeScene 和摇杆控制器
- **涉及文件**：
  - 新建 `src/pages/SnakeGamePage.tsx`
  - 修改 `src/router/index.tsx`（添加路由）
- **验收标准**：页面可访问，游戏可运行

#### 任务 3.2：实现游戏内 HUD
- **目标**：左上角显示当前分数/最高分，右上角暂停按钮
- **验收标准**：HUD 显示正确，暂停按钮可用

#### 任务 3.3：实现游戏状态界面
- **目标**：开始界面、暂停界面、结束界面
- **验收标准**：三种状态界面切换正常

#### 任务 3.4：注册游戏到游戏列表
- **目标**：在 `/public/data/games.json` 添加贪吃蛇游戏入口
- **验收标准**：首页可见游戏入口，点击可进入

---

## 任务依赖关系

```
阶段 1（摇杆）→ 阶段 2（核心逻辑）→ 阶段 3（UI）

任务 1.1 → 任务 2.1 → 任务 2.2 → 任务 2.3
                              ↓
                        任务 2.4 → 任务 2.5 → 任务 2.6
                                                  ↓
                        任务 3.1 → 任务 3.2 → 任务 3.3 → 任务 3.4
```

---

## 文件清单

### 新建文件
- `src/components/VirtualController/Joystick.tsx`
- `src/game/games/SnakeGame/SnakeScene.ts`
- `src/pages/SnakeGamePage.tsx`

### 修改文件
- `src/components/VirtualController/index.tsx`
- `src/router/index.tsx`
- `public/data/games.json`
